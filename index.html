<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title>Puget Sound Bulletin Content Generator</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel='shortcut icon' type='image/x-icon' href='favicon.ico' />

  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">

  <meta name="theme-color" content="#fafafa">
</head>

<body>
  <div id="system" style="display:none;">CSPRD &nbsp;&nbsp;&nbsp;CSPRD &nbsp;&nbsp;&nbsp;CSPRD &nbsp;&nbsp;&nbsp;CSPRD &nbsp;&nbsp;&nbsp;CSPRD</div>
  <div id="departments-container">
  <!-- Add your site or application content here -->
  <p>Puget Sound Bulletin Content Generator</p>
  <label for="term-select">Choose an academic year</label>

<select name="term" id="term-select">
    <option value="2020">2020</option>
    <option value="2020" selected>2020</option>
    <option value="2020">2020</option>
</select>

<ul id="departments"></ul>

<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.7/handlebars.min.js"></script>
<script src="js/config.js"></script>
<script src="js/departments.js"></script>

<script id="departments-template" type="text/x-handlebars-template">
  {{#each acad_orgs}}
  <li><a href="display.html?department={{acad_org}}&year=2022&system={{../system_href}}">{{acad_org_descr}}</a></li>
  {{/each}}
</script>

<br><br>
<label for="system-select">Choose a system</label>

<select name="system" id="system-select">
  <option value="csprd" selected>PRD</option>
  <option value="cstst">TST</option>
  <option value="cststp">TSTp</option>
  <option value="csdev">DEV</option>
  <option value="csdevp">DEVp</option>
</select>

<script>
var selectElement = document.querySelector('#term-select');

selectElement.addEventListener('change', (event) => {
  var elements = document.querySelectorAll("#departments > li > a");
  for (var i = 0; i < elements.length; i++) {
      var href = elements[i].getAttribute("href");
      var newHref = href.replace(/(year=).*?(&|$)/,'$1' + event.target.value + '$2');
      elements[i].setAttribute("href", newHref);
  }

});

var systemElement = document.querySelector('#system-select');

systemElement.addEventListener('change', (event) => {
  document.getElementById("system").style.display = 'none';
  var bulletinSystem = event.target.value;
  if(bulletinSystem === "cststp") {
    bulletinSystem = 'campus-tstp';
  }
  else {
    bulletinSystem = bulletinSystem + '-integration';
  }
  bulletinDeptsApiUrl = bulletinDeptsApiUrl.replace(/^(https?:\/\/)(www\.)?([^.])*/, '$1$2' + bulletinSystem);

  listDepartments(event.target.value);

  if(event.target.value !== 'csprd') {
    document.getElementById("system").innerHTML = event.target.value + " &nbsp;&nbsp;&nbsp;" + event.target.value + " &nbsp;&nbsp;&nbsp;" + event.target.value + " &nbsp;&nbsp;&nbsp;" + event.target.value + " &nbsp;&nbsp;&nbsp;" + event.target.value;
    document.getElementById("system").style.display = 'block';
    document.getElementById("system").classList.add("system-" + event.target.value);
  }
});

</script>
</div>
</body>

</html>
